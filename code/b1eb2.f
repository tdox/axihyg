
      subroutine B1EB2(B1,B2,E,KE12)
c     Name:      B1EB1
c     Purpose:   To perform the multiplication KE12=B1t*EMAT*B2
c     Common:
c     Input:     B1,B2 and EMAT

c     Output:    KES
c     Called by: KESHRT
c     Calls    :
c                                                                      |
c*******************************************************************************

      implicit  none

      include   'n.par'

      real*8   B1(MXNEPS,MXNVAR), B2(MXNEPS,MXNVAR),
     &         KE12(MXNVAR,MXNVAR),E(MXNEPS,MXNEPS)
     
     
     
      KE12(1,1) = B1(9,1)*B2(9,1)*E(9,9)+B1(2,1)*(B2(2,1)*E(2,2)+B2(1,1)
     1   *E(1,2))+B1(1,1)*(E(1,2)*B2(2,1)+B2(1,1)*E(1,1))
      KE12(1,2) = B1(9,1)*B2(9,2)*E(9,9)+B1(2,1)*(B2(2,2)*E(2,2)+B2(1,2)
     1   *E(1,2))+B1(1,1)*(E(1,2)*B2(2,2)+E(1,1)*B2(1,2))
      KE12(2,1) = B2(9,1)*E(9,10)*B1(10,2)+(B2(2,1)*E(2,4)+B2(1,1)*E(1,4
     1   ))*B1(4,2)+(B2(2,1)*E(2,3)+B2(1,1)*E(1,3))*B1(3,2)+B1(2,2)*(B2(
     2   2,1)*E(2,2)+B2(1,1)*E(1,2))
      KE12(2,2) = B2(9,2)*E(9,10)*B1(10,2)+(B2(2,2)*E(2,4)+B2(1,2)*E(1,4
     1   ))*B1(4,2)+(B2(2,2)*E(2,3)+B2(1,2)*E(1,3))*B1(3,2)+B1(2,2)*(B2(
     2   2,2)*E(2,2)+B2(1,2)*E(1,2))
      KE12(3,1) = B2(9,1)*B1(9,3)*E(9,9)+(B2(2,1)*E(2,2)+B2(1,1)*E(1,2))
     1   *B1(2,3)+B1(1,3)*(E(1,2)*B2(2,1)+B2(1,1)*E(1,1))
      KE12(3,2) = B2(9,2)*B1(9,3)*E(9,9)+(B2(2,2)*E(2,2)+B2(1,2)*E(1,2))
     1   *B1(2,3)+B1(1,3)*(E(1,2)*B2(2,2)+E(1,1)*B2(1,2))
      KE12(4,1) = B2(9,1)*B1(9,4)*E(9,9)+(B2(2,1)*E(2,6)+B2(1,1)*E(1,6))
     1   *B1(6,4)+(B2(2,1)*E(2,5)+B2(1,1)*E(1,5))*B1(5,4)
      KE12(4,2) = B2(9,2)*B1(9,4)*E(9,9)+(B2(2,2)*E(2,6)+B2(1,2)*E(1,6))
     1   *B1(6,4)+(B2(2,2)*E(2,5)+B2(1,2)*E(1,5))*B1(5,4)
      KE12(5,1) = B2(9,1)*E(9,10)*B1(10,5)+(B2(2,1)*E(2,8)+B2(1,1)*E(1,8
     1   ))*B1(8,5)+(B2(2,1)*E(2,7)+B2(1,1)*E(1,7))*B1(7,5)
      KE12(5,2) = B2(9,2)*E(9,10)*B1(10,5)+(B2(2,2)*E(2,8)+B2(1,2)*E(1,8
     1   ))*B1(8,5)+(B2(2,2)*E(2,7)+B2(1,2)*E(1,7))*B1(7,5)
      KE12(6,1) = B2(9,1)*E(9,12)*B1(12,6)+(B2(2,1)*E(2,11)+B2(1,1)*E(1,
     1   11))*B1(11,6)+(B2(2,1)*E(2,6)+B2(1,1)*E(1,6))*B1(6,6)+(B2(2,1)*
     2   E(2,5)+B2(1,1)*E(1,5))*B1(5,6)
      KE12(6,2) = B2(9,2)*E(9,12)*B1(12,6)+(B2(2,2)*E(2,11)+B2(1,2)*E(1,
     1   11))*B1(11,6)+(B2(2,2)*E(2,6)+B2(1,2)*E(1,6))*B1(6,6)+(B2(2,2)*
     2   E(2,5)+B2(1,2)*E(1,5))*B1(5,6)
      KE12(7,1) = B2(9,1)*E(9,23)*B1(23,7)+(B2(2,1)*E(2,16)+B2(1,1)*E(1,
     1   16))*B1(16,7)+(B2(2,1)*E(2,15)+B2(1,1)*E(1,15))*B1(15,7)+(B2(2,
     2   1)*E(2,14)+B2(1,1)*E(1,14))*B1(14,7)
      KE12(7,2) = B2(9,2)*E(9,23)*B1(23,7)+(B2(2,2)*E(2,16)+B2(1,2)*E(1,
     1   16))*B1(16,7)+(B2(2,2)*E(2,15)+B2(1,2)*E(1,15))*B1(15,7)+(B2(2,
     2   2)*E(2,14)+B2(1,2)*E(1,14))*B1(14,7)
      KE12(8,1) = B2(9,1)*E(9,25)*B1(25,8)+B2(9,1)*E(9,23)*B1(23,8)+(B2(
     1   2,1)*E(2,20)+B2(1,1)*E(1,20))*B1(20,8)+(B2(2,1)*E(2,19)+B2(1,1)
     2   *E(1,19))*B1(19,8)
      KE12(8,2) = B2(9,2)*E(9,25)*B1(25,8)+B2(9,2)*E(9,23)*B1(23,8)+(B2(
     1   2,2)*E(2,20)+B2(1,2)*E(1,20))*B1(20,8)+(B2(2,2)*E(2,19)+B2(1,2)
     2   *E(1,19))*B1(19,8)
      KE12(9,1) = B2(9,1)*E(9,26)*B1(26,9)+B2(9,1)*E(9,24)*B1(24,9)+(B2(
     1   2,1)*E(2,22)+B2(1,1)*E(1,22))*B1(22,9)+(B2(2,1)*E(2,21)+B2(1,1)
     2   *E(1,21))*B1(21,9)
      KE12(9,2) = B2(9,2)*E(9,26)*B1(26,9)+B2(9,2)*E(9,24)*B1(24,9)+(B2(
     1   2,2)*E(2,22)+B2(1,2)*E(1,22))*B1(22,9)+(B2(2,2)*E(2,21)+B2(1,2)
     2   *E(1,21))*B1(21,9)
      KE12(10,1) = B2(9,1)*E(9,23)*B1(23,10)+(B2(2,1)*E(2,16)+B2(1,1)*E(
     1   1,16))*B1(16,10)+(B2(2,1)*E(2,15)+B2(1,1)*E(1,15))*B1(15,10)+B2
     2   (9,1)*E(9,12)*B1(12,10)
      KE12(10,2) = B2(9,2)*E(9,23)*B1(23,10)+(B2(2,2)*E(2,16)+B2(1,2)*E(
     1   1,16))*B1(16,10)+(B2(2,2)*E(2,15)+B2(1,2)*E(1,15))*B1(15,10)+B2
     2   (9,2)*E(9,12)*B1(12,10)
      KE12(11,1) = B2(9,1)*E(9,24)*B1(24,11)+(B2(2,1)*E(2,18)+B2(1,1)*E(
     1   1,18))*B1(18,11)+(B2(2,1)*E(2,17)+B2(1,1)*E(1,17))*B1(17,11)+B2
     2   (9,1)*E(9,13)*B1(13,11)
      KE12(11,2) = B2(9,2)*E(9,24)*B1(24,11)+(B2(2,2)*E(2,18)+B2(1,2)*E(
     1   1,18))*B1(18,11)+(B2(2,2)*E(2,17)+B2(1,2)*E(1,17))*B1(17,11)+B2
     2   (9,2)*E(9,13)*B1(13,11)
      KE12(12,1) = (B2(2,1)*E(2,27)+B2(1,1)*E(1,27))*B1(27,12)+(B2(2,1)*
     1   E(2,20)+B2(1,1)*E(1,20))*B1(20,12)+(B2(2,1)*E(2,19)+B2(1,1)*E(1
     2   ,19))*B1(19,12)
      KE12(12,2) = (B2(2,2)*E(2,27)+B2(1,2)*E(1,27))*B1(27,12)+(B2(2,2)*
     1   E(2,20)+B2(1,2)*E(1,20))*B1(20,12)+(B2(2,2)*E(2,19)+B2(1,2)*E(1
     2   ,19))*B1(19,12)

  
      return
      end






